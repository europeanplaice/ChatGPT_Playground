(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7432:function(e,t,n){Promise.resolve().then(n.bind(n,4874))},4874:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var a=n(9268),i=n(6006),r=n(4214),l=n(7807),s=n(1771),o=n(3607),c=n(7931),d=n(4864),u=n(4310),h=n(2525),g=n(1710),x=n(5383),m=n(3370),p=n(4240);let f=async(e,t)=>{try{let n=await (0,r.Z)(e,t);return n.data}catch(e){throw e}},j=e=>{let t=e.split("\n");return t.map((e,t)=>(0,a.jsxs)(i.Fragment,{children:[e,(0,a.jsx)("br",{})]},t))};async function y(e,t,n,a,i,r){let l=[...t,...n];l.sort((e,t)=>e.id-t.id);let s=await f("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer ".concat(i.apikey),"OpenAI-Organization":"".concat(i.Organization),"Content-Type":"application/json"},data:{model:"gpt-3.5-turbo",messages:l.map(e=>{let{id:t,...n}=e;return n})}});a(e=>[...e,{id:r,role:"assistant",content:s.choices[0].message.content}])}function Z(e,t){if(0===e.length&&0===t.length)return 1;let n=[...e,...t],a=Math.max(...n.map(e=>e.id));return a+1}function k(){let[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)([]),[f,k]=(0,i.useState)([]),[O,b]=(0,i.useState)(""),[z,S]=(0,i.useState)(!1),[v,C]=(0,i.useState)(null),[E,I]=(0,i.useState)(null),[w,_]=(0,i.useState)({Organization:"",apikey:""});(0,i.useEffect)(()=>{t(()=>{let e=[...n,...f];return e.sort((e,t)=>e.id-t.id),e})},[n,f]);let P=async()=>{S(!0),C(null);try{await y(O,n,f,k,w,Z(n,f))}catch(e){C(e.message),r(e=>{e.pop();let t=[...e];return t})}finally{S(!1),b(""),I(null)}};return(0,i.useEffect)(()=>{n.length>0&&P()},[n]),(0,i.useEffect)(()=>{_(()=>({apikey:localStorage.getItem("apikey"),Organization:localStorage.getItem("Organization")}))},[]),(0,i.useEffect)(()=>{""!==w.apikey&&localStorage.setItem("apikey",w.apikey)},[w.apikey]),(0,i.useEffect)(()=>{""!==w.Organization&&localStorage.setItem("Organization",w.Organization)},[w.Organization]),(0,a.jsxs)(l.Z,{maxWidth:"md",children:[(0,a.jsx)("h1",{children:"Test ChatGPT"}),(0,a.jsxs)(h.Z,{sx:{marginBottom:"1em",maxWidth:"60%"},children:[(0,a.jsx)(g.Z,{expandIcon:(0,a.jsx)(m.Z,{}),children:"API Config"}),(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(o.Z,{label:"Organization ID",type:"text",sx:{marginRight:"4px",marginBottom:"8px"},value:w.Organization,onChange:e=>{_(t=>({...t,Organization:e.target.value}))}}),(0,a.jsx)(o.Z,{label:"API KEY",type:"password",sx:{marginBottom:"8px"},value:w.apikey,onChange:e=>_(t=>({...t,apikey:e.target.value}))})]})]}),v&&(0,a.jsx)(u.Z,{severity:"error",children:v}),(0,a.jsxs)(s.Z,{sx:{margin:"1em"},children:[e.map((e,t)=>(0,a.jsxs)(s.Z,{children:[(0,a.jsx)("h2",{children:e.role}),(0,a.jsx)(s.Z,{children:j(e.content)}),(0,a.jsx)(s.Z,{}),e.id===Math.max(...n.map(e=>e.id))?(0,a.jsxs)(s.Z,{sx:{margin:"1em"},children:[(0,a.jsx)(c.Z,{onClick:()=>{I(e.id),b(e.content)},variant:"contained",disabled:!!E||!!z,children:"Edit"}),E?(0,a.jsx)(c.Z,{onClick:()=>I(null),disabled:z,children:"Cancel"}):""]}):"",(0,a.jsx)("hr",{})]},t)),z?(0,a.jsx)(d.Z,{color:"secondary"}):""]}),(0,a.jsxs)(s.Z,{children:[(0,a.jsx)(p.Z,{children:E?"Edit Mode":""}),(0,a.jsx)(o.Z,{id:"outlined-multiline-flexible",label:"message",multiline:!0,maxRows:100,fullWidth:!0,value:O,onChange:e=>b(e.target.value),disabled:z}),(0,a.jsx)(c.Z,{sx:{margin:"1em"},onClick:()=>{r(e=>{if(null===E)return[...e,{id:Z(n,f),role:"user",content:O}];{let t=e.findIndex(e=>e.id===E),n=[...e];return n[t].content=O,n}}),null!==E&&k(e=>{e.pop();let t=[...e];return t})},variant:"contained",disabled:z,children:z?"sending...":"send"})]})]})}}},function(e){e.O(0,[171,667,488,744],function(){return e(e.s=7432)}),_N_E=e.O()}]);